#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<math.h>
#include<stdbool.h>
#include<string.h>
/*918. Maximum Sum Circular Subarray
Given a circular integer array nums of length n, return the maximum possible sum of a non-empty subarray of nums.

A circular array means the end of the array connects to the beginning of the array. Formally, the next element of nums[i] is nums[(i + 1) % n] and the previous element of nums[i] is nums[(i - 1 + n) % n].

A subarray may only include each element of the fixed buffer nums at most once. Formally, for a subarray nums[i], nums[i + 1], ..., nums[j], there does not exist i <= k1, k2 <= j with k1 % n == k2 % n.

 

Example 1:

Input: nums = [1,-2,3,-2]
Output: 3
Explanation: Subarray [3] has maximum sum 3
Example 2:

Input: nums = [5,-3,5]
Output: 10
Explanation: Subarray [5,5] has maximum sum 5 + 5 = 10
Example 3:

Input: nums = [3,-1,2,-1]
Output: 4
Explanation: Subarray [2,-1,3] has maximum sum 2 + (-1) + 3 = 4
Example 4:

Input: nums = [3,-2,2,-3]
Output: 3
Explanation: Subarray [3] and [3,-2,2] both have maximum sum 3
Example 5:

Input: nums = [-2,-3,-1]
Output: -1
Explanation: Subarray [-1] has maximum sum -1
 

Constraints:

n == nums.length
1 <= n <= 3 * 104
-3 * 104 <= nums[i] <= 3 * 104
*/


#define INT_MIN -2147483647-1
int sumSub(int* nums, int numsSize,int start, int end);
int maxSubarraySumCircular(int* nums, int numsSize);
int maxSubarraySumCircular_hu(int* nums, int numsSize);

void main()
{
    printf("woody\n");
    //int a[4]={1,-2,3,-2}; //3
    //int a[4] = {3,-1,2,-1}; //4
    //int a[3] = {-2,-3,-1};  //-1

    //9908
    int a[] = {-744,843,-599,711,370,-483,672,-827,380,555,-756,949,-768,151,-608,478,993,146,-288,-596,-440,-333,301,42,-428,-182,-652,954,705,-330,626,-706,-405,334,657,-532,528,-877,-736,101,-751,-789,23,-122,995,-602,-938,-57,521,-731,-432,-432,-11,-376,-190,535,-549,889,-570,25,-588,477,442,668,-575,-869,-550,-9,-239,-858,705,-382,-309,447,716,652,-782,300,803,-287,-351,806,308,908,-640,555,-715,-356,860,310,167,-708,756,266,39,297,534,-871,-522,785,798,-4,767,291,135,-385,-315,-288,-806,765,96,179,562,511,344,537,-10,-650,-241,-689,-769,-758,-704,775,752,-901,797,-838,236,953,-198,563,-382,-558,-851,397,138,954,-185,0,-221,-964,-861,-312,425,-925,-603,-202,418,965,0,-186,266,-922,801,935,351,461,-861,-467,-850,-684,466,709,-931,395,56,873,443,-342,-79,783,191,806,549,-388,-780,-898,-493,194,297,-364,143,-162,831,-468,608,-921,703,-262,-36,715,233,718,-398,957,-221,777,189,220,687,840,-301,-433,-776,-459,-763,290,197,-151,-137,120,-50,-914,570,-902,-96,-551,739,165,579,-720,-113,952,-619,-374,244,-38,6,-301,-890,891,194,451,-770,-791,-690,-941,-207,-792,-483,406,508,145,898,873,142,-83,-380,-494,904,-907,630,-486,-687,-720,-919,-123,364,315,668,841,29,-54,-957,841,-465,-364,-406,-407,-827,301,-37,-40,-550,94,-469,496,990,-927,-999,169,965,-637,361,-718,11,-995,-404,-834,803,27,-867,-514,576,923,703,33,277,396,-923,-532,544,85,-821,895,366,600,-324,-282,392,-208,-118,785,-285,94,37,-63,750,-86,310,432,-261,-349,244,887,-370,-549,328,-153,-173,-78,-28,-887,-845,49,254,-821,342,586,215,108,721,346,-400,-504,-250,-847,-165,731,-528,-452,-742,318,909,-665,-896,189,-383,-955,518,79,-46,200,391,-380,895,891,-144,689,626,842,-707,369,-163,-68,-522,75,602,838,154,30,5,418,-267,-581,-874,568,266,-234,-7,149,-878,-238,-696,-585,205,-739,573,-423,-420,-380,-628,628,30,621,165,900,-723,17,680,-749,-400,-985,990,598,-629,-176,-735,195,-902,-356,168,284,-407,847,-433,-700,-195,-894,841,888,-737,638,-119,497,47,649,-206,178,-62,-121,-874,-903,-653,-21,62,23,-116,676,947,-75,663,599,406,-266,40,-613,397,-510,847,-145,798,-545,-723,-657,531,-943,-196,-782,-776,-886,-902,748,501,-585,448,190,252,237,453,102,-813,-846,-715,-484,391,637,-341,-451,-468,-983,-916,608,511,296,394,-701,589,786,619,888,-64,-639,329,548,477,682,-445,757,61,857,-358,-133,-264,-511,871,-159,606,-729,41,999,-549,201,120,680,-86,-644,-383,-982,-878,-110,237,-140,-697,512,151,961,119,-444,-560,748,991,361,-438,-544,657,-182,353,-877,245,-362,140,-958,-348,633,-921,731,-241,333,909,241,308,-207,-371,-615,831,78,-313,-92,-745,-328,272,-493,244,49,-717,-961,676,776,-618,-513,390,270,338,-596,-276,117,-116,207,-817,-407,-721,-81,851,741,580,-771,-415,-199,-760,-363,-403,733,814,-483,412,-287,339,251,435,216,-177,398,-948,-930,-691,-95,-796,-790,764,-959,-82,168,-574,-21,152,-642,-154,-804,-511,567,-964,260,21,-206,-142,-400,-196,606,894,211,820,484,34,77,-671,664,-653,-807,-646,850,276,-447,343,-716,802,-717,408,-150,-926,-56,140,37,-528,694,-392,-373,266,-338,34,142,-467,65,-407,-856,526,805,579,-440,-971,-975,5,-757,568,-486,-475,-113,-491,-394,-474,-549,-360,72,680,554,508,-412,906,-987,-428,-655,274,-543,-790,263,739,244,62,702,-772,878,-769,-991,912,309,-658,961,397,-638,-75,90,-551,262,887,-940,707,766,-955,-270,908,267,-923,-660,-541,352,-849,343,648,-619,141,-389,122,95,373,588,273,598,-85,550,684,-543,-531,869,413,412,247,981,773,673,-657,663,423,-735,-439,467,-368,-419,308,-725,-553,-588,431,-420,218,-677,649,696,969,-769,558,548,-486,-28,550,-647,-282,-35,395,711,189,296,488,273,540,854,780,-754,-931,833,-719,-862,-88,-487,591,-165,584,-640,502,-308,219,390,713,-732,228,-759,488,675,-300,-153,105,269,-240,462,-825,-638,299,-65,-576,-222,-929,481,-404,687,-574,-81,-365,-844,530,298,-681,676,-304,-528,-4,431,-35,311,669,-392,-998,983,466,-350,-62,-457,-807,7,821,-835,-291,-433,171,-510,-309,-509,-981,422,-820,-753,342,803,79,886,-233,551,-595,-272,289,-159,470,36,-882,-773,916,446,-79,-500,-240,199,703,391,-316,-273,-659,-781,836,-409,-688,-287,230,-254,575,-529,-431,-985,-451,244,-503,-321,-196,-116,-340,-460,433,-428,-977,127,-256,485,-940,876,574,646,-596,-315,976,249,108,-983,277,388,269,6,504,734,-267,86,143,-979,504,-569,827,-935,-499,-63,-67,117,472,-31,-904,-361,-122,700,-889,978,620,-954,-396,248,-885,-588,1000,438,305,-635,455,620,-566,445,-107,114,-317,575,-241,58,717,-52,977,900,-603,-659,-266,692,-750,-769,952,-648,-213,-545,715,129,-160,126,322,-162,205,386,608,654};
    int b = 0;
    b = maxSubarraySumCircular(a, sizeof(a)/sizeof(a[0]));
    printf("b = %d\n", b);

    return; 
}


// +++ 1
/*
    Runtime: 131 ms, faster than 19.05% of C online submissions for Maximum Sum Circular Subarray.
    Memory Usage: 8.5 MB, less than 57.14% of C online submissions for Maximum Sum Circular Subarray.
*/
int maxSubArray(int* nums, int numsSize)
{
    int maxSubArry = nums[0];
    int maxPrevArray = 0;
    int i, choose, choose2;

    for(i=1;i<numsSize;i++)
    {
        choose = maxPrevArray + nums[i-1];
        if(choose < 0)
            maxPrevArray = 0;
        else
            maxPrevArray = choose;

        choose2 = maxPrevArray + nums[i];
        if(maxSubArry > choose2)
            maxSubArry = maxSubArry;
        else
            maxSubArry = choose2;
    }

    return maxSubArry;
}

int maxSubarraySumCircular(int* nums, int numsSize)
{
    int chooseMiddle = maxSubArray(nums, numsSize);
    int total = 0, i = 0, result = 0;
    int notChooseMiddle = 0;

    for(i=0;i<numsSize;i++)
    {
        total += nums[i];
    }
    for(i=0;i<numsSize;i++)
    {
         nums[i] *= -1;
    }

    result = maxSubArray(nums, numsSize);

    if(result != -total)
    {
        notChooseMiddle =  total + result;
        if(chooseMiddle > notChooseMiddle)
            return chooseMiddle;
        return notChooseMiddle;
    }
    else   
        return chooseMiddle;
}
// +++ 1


//+++ Time Limit Exceeded
int sumSub(int* nums, int numsSize,int start, int end)
{
    int sum = 0;
    int index = start;

    while(index != end)
    {
        sum = sum + nums[index];
        if( (index+1) >= numsSize )
            index = 0;
        else
            index++;
    }
    sum = sum + nums[end];

    return sum;
}

int maxSubarraySumCircular_hu(int* nums, int numsSize)
{
    int start = 0, end = 0;
    int Max = INT_MIN, Temp = 0;

    for(start=0;start<numsSize;start++)
    {
        Temp = 0;
        for(end=0;end<numsSize;end++)
        {
            Temp = sumSub(nums, numsSize, start, end);
            if(Temp > Max)
                Max = Temp;
        }
    }

    return Max;
}
//+++ Time Limit Exceeded